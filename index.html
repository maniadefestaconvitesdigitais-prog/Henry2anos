<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Henrique 2 Anos</title>

<style>
    html, body {
        margin: 0;
        padding: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        background: black;
    }

    video {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        object-fit: cover;
        z-index: 1;
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        object-fit: contain;
        z-index: 3;
        pointer-events: none;
    }

    .controls {
        position: fixed;
        bottom: env(safe-area-inset-bottom, 20px);
        width: 100%;
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 4;
        padding: 10px 0;
    }

    .btn {
        width: 65px;
        height: 65px;
        background: white;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 26px;
        cursor: pointer;
        border: none;
        font-weight: bold;
        user-select: none;
    }
</style>
</head>

<body>

<video id="camera" autoplay playsinline></video>
<img class="overlay" src="Moldura sua vez _20251205_115536_0000.png">

<div class="controls">
    <div class="btn" id="flip">ðŸ”„</div>
    <div class="btn" id="capture">ðŸ“¸</div>
    <div class="btn" id="record">ðŸŽ¥</div>
</div>

<canvas id="snapshot" style="display:none;"></canvas>

<script>
let isFront = true;
let stream;
const camera = document.getElementById("camera");
const captureBtn = document.getElementById("capture");
const flipBtn = document.getElementById("flip");

function startCamera() {
    navigator.mediaDevices.getUserMedia({
        video: { facingMode: isFront ? "user" : "environment" }
    })
    .then(s => {
        stream = s;
        camera.srcObject = s;
    })
    .catch(() => alert("âš ï¸ Permita acesso Ã  cÃ¢mera!"));
}

flipBtn.addEventListener("click", () => {
    isFront = !isFront;
    if (stream) stream.getTracks().forEach(t => t.stop());
    startCamera();
});

captureBtn.addEventListener("click", () => {
    const canvas = document.getElementById("snapshot");
    const context = canvas.getContext("2d");

    canvas.width = camera.videoWidth;
    canvas.height = camera.videoHeight;

    context.drawImage(camera, 0, 0, canvas.width, canvas.height);

    const img = new Image();
    img.src = document.querySelector(".overlay").src;
    img.onload = () => {
        context.drawImage(img, 0, 0, canvas.width, canvas.height);
        const link = document.createElement("a");
        link.download = "foto-henrique2anos.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
    }
});

startCamera();
</script>

</body>
</html>
